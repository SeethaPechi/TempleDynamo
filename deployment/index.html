<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nam Kovil - Divine Portal</title>
    <style>
        * { 
            margin: 0; 
            padding: 0; 
            box-sizing: border-box; 
        }
        
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #fff8dc 0%, #ffeaa7 100%); 
            min-height: 100vh; 
            color: #2c3e50; 
        }
        
        .nav { 
            background: rgba(255,255,255,0.95); 
            border-bottom: 4px solid #f39c12; 
            position: sticky; 
            top: 0; 
            z-index: 100; 
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
        }
        
        .nav-content { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 1rem 2rem; 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
        }
        
        .nav-brand { 
            display: flex; 
            align-items: center; 
            gap: 12px; 
            text-decoration: none; 
            color: #8B4513; 
        }
        
        .nav-brand .logo { 
            width: 40px; 
            height: 40px; 
            background: linear-gradient(135deg, #ff6b6b, #f39c12); 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            font-size: 20px; 
        }
        
        .nav-brand h1 { 
            font-size: 24px; 
            font-weight: bold; 
        }
        
        .nav-links { 
            display: flex; 
            gap: 2rem; 
            list-style: none; 
            align-items: center; 
            flex-wrap: wrap;
        }
        
        .nav-link { 
            color: #2c3e50; 
            text-decoration: none; 
            font-weight: 500; 
            padding: 0.5rem 1rem; 
            border-radius: 6px; 
            transition: all 0.3s; 
            cursor: pointer; 
        }
        
        .nav-link:hover, .nav-link.active { 
            background: rgba(243,156,18,0.2); 
            color: #f39c12; 
        }
        
        .temple-selector { 
            background: white; 
            border-bottom: 1px solid #ddd; 
            padding: 1rem 0; 
        }
        
        .temple-selector-content { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 0 2rem; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 1rem; 
        }
        
        .select { 
            min-width: 300px; 
            padding: 0.75rem 1rem; 
            border: 2px solid #f39c12; 
            border-radius: 6px; 
            font-size: 16px; 
        }
        
        .main-content { 
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 2rem; 
        }
        
        .hero { 
            text-align: center; 
            margin-bottom: 3rem; 
        }
        
        .hero-icon { 
            width: 80px; 
            height: 80px; 
            margin: 0 auto 1rem; 
            background: #f39c12; 
            border-radius: 12px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 40px; 
            color: white; 
        }
        
        .hero-title { 
            font-size: 48px; 
            font-weight: bold; 
            color: #8B4513; 
            margin-bottom: 1rem; 
        }
        
        .hero-subtitle { 
            font-size: 20px; 
            color: #f39c12; 
            margin-bottom: 0.5rem; 
        }
        
        .stats-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
            gap: 1.5rem; 
            margin-bottom: 3rem; 
        }
        
        .stat-card { 
            background: linear-gradient(135deg, #fff8dc 0%, #ffffff 100%); 
            border-radius: 12px; 
            padding: 2rem; 
            text-align: center; 
            cursor: pointer; 
            transition: all 0.3s; 
            border: 2px solid transparent; 
        }
        
        .stat-card:hover { 
            transform: translateY(-3px); 
            border-color: #f39c12; 
            box-shadow: 0 8px 25px rgba(0,0,0,0.15); 
        }
        
        .stat-icon { 
            font-size: 40px; 
            margin-bottom: 1rem; 
        }
        
        .stat-number { 
            font-size: 40px; 
            font-weight: bold; 
            color: #8B4513; 
            margin-bottom: 0.5rem; 
        }
        
        .stat-label { 
            font-size: 14px; 
            color: #666; 
            font-weight: 500; 
            text-transform: uppercase; 
        }
        
        .content-area { 
            background: white; 
            border-radius: 12px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.1); 
            min-height: 400px; 
            overflow: hidden; 
        }
        
        .content-header { 
            background: linear-gradient(135deg, #f39c12 0%, #ff6b6b 100%); 
            color: white; 
            padding: 1.5rem 2rem; 
        }
        
        .content-body { 
            padding: 2rem; 
        }
        
        .loading { 
            text-align: center; 
            padding: 2rem; 
            color: #666; 
        }
        
        .error { 
            text-align: center; 
            padding: 2rem; 
            color: #e74c3c; 
            background: #ffeaea; 
            border-radius: 8px; 
        }
        
        .member-grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); 
            gap: 1rem; 
        }
        
        .member-card { 
            background: #f8f9fa; 
            border-radius: 8px; 
            padding: 1.5rem; 
            border: 1px solid #dee2e6; 
        }
        
        .member-name { 
            font-size: 18px; 
            font-weight: bold; 
            color: #8B4513; 
            margin-bottom: 0.5rem; 
        }
        
        .member-info { 
            color: #666; 
            margin-bottom: 0.25rem; 
        }
        
        .status-indicator { 
            display: inline-block; 
            width: 12px; 
            height: 12px; 
            border-radius: 50%; 
            margin-right: 8px; 
        }
        
        .status-connected { 
            background: #27ae60; 
        }
        
        .status-disconnected { 
            background: #e74c3c; 
        }
        
        @media (max-width: 768px) { 
            .nav-links { 
                flex-wrap: wrap; 
                gap: 1rem; 
            } 
            .hero-title { 
                font-size: 32px; 
            } 
        }
    </style>
</head>
<body>
    <nav class="nav">
        <div class="nav-content">
            <a href="#" class="nav-brand">
                <div class="logo">‡•ê</div>
                <h1>Nam Kovil</h1>
            </a>
            <ul class="nav-links">
                <li><a href="#" class="nav-link active" onclick="showPage('home')">Home</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('registry')">Registry</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('members')">Members</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('family')">Family Tree</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('temples')">Temples</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('temple-registry')">Temple Registry</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('temple-members')">Temple Members</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('whatsapp')">WhatsApp</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('english')">English</a></li>
            </ul>
        </div>
    </nav>
    
    <div class="temple-selector">
        <div class="temple-selector-content">
            <span>üèõÔ∏è Select Temple</span>
            <select class="select" id="templeSelect">
                <option value="">All Temples</option>
            </select>
        </div>
    </div>
    
    <main class="main-content">
        <div class="hero">
            <div class="hero-icon">‡•ê</div>
            <h1 class="hero-title">Welcome to your temple</h1>
            <p class="hero-subtitle">Temple Information Portal</p>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card" onclick="showPage('members')">
                <div class="stat-icon">üë•</div>
                <div class="stat-number" id="memberCount">Loading...</div>
                <div class="stat-label">Total Members</div>
            </div>
            <div class="stat-card" onclick="showPage('temples')">
                <div class="stat-icon">‚ù§Ô∏è</div>
                <div class="stat-number" id="templeCount">Loading...</div>
                <div class="stat-label">Temples</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìÖ</div>
                <div class="stat-number" id="relationshipCount">Loading...</div>
                <div class="stat-label">Relationships</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üîó</div>
                <div class="stat-number"><span class="status-indicator" id="dbStatus"></span><span id="dbStatusText">Checking...</span></div>
                <div class="stat-label">Database Status</div>
            </div>
        </div>
        
        <div class="content-area" id="contentArea">
            <div class="loading">Welcome to Nam Kovil Community Portal</div>
        </div>
    </main>
    
    <script>
        let membersData = [];
        let templesData = [];
        let relationshipsData = [];
        
        async function loadData() {
            try {
                const [membersRes, templesRes, relationshipsRes, healthRes] = await Promise.all([
                    fetch('/api/members'),
                    fetch('/api/temples'),
                    fetch('/api/relationships'),
                    fetch('/api/health')
                ]);
                
                if (membersRes.ok) {
                    membersData = await membersRes.json();
                    document.getElementById('memberCount').textContent = membersData.length;
                }
                
                if (templesRes.ok) {
                    templesData = await templesRes.json();
                    document.getElementById('templeCount').textContent = templesData.length;
                    
                    // Populate temple selector
                    const select = document.getElementById('templeSelect');
                    templesData.forEach(temple => {
                        const option = document.createElement('option');
                        option.value = temple.id;
                        option.textContent = temple.templeName || temple.temple_name || 'Unknown Temple';
                        select.appendChild(option);
                    });
                }
                
                if (relationshipsRes.ok) {
                    relationshipsData = await relationshipsRes.json();
                    document.getElementById('relationshipCount').textContent = relationshipsData.length;
                }
                
                if (healthRes.ok) {
                    document.getElementById('dbStatus').className = 'status-indicator status-connected';
                    document.getElementById('dbStatusText').textContent = 'Connected';
                } else {
                    document.getElementById('dbStatus').className = 'status-indicator status-disconnected';
                    document.getElementById('dbStatusText').textContent = 'Disconnected';
                }
            } catch (error) {
                console.error('Error loading data:', error);
                document.getElementById('dbStatus').className = 'status-indicator status-disconnected';
                document.getElementById('dbStatusText').textContent = 'Error';
            }
        }
        
        function showPage(page) {
            const contentArea = document.getElementById('contentArea');
            const navLinks = document.querySelectorAll('.nav-link');
            
            navLinks.forEach(link => link.classList.remove('active'));
            event.target.classList.add('active');
            
            switch(page) {
                case 'members':
                    showMembers();
                    break;
                case 'temples':
                    showTemples();
                    break;
                case 'registry':
                    showRegistry();
                    break;
                case 'family':
                    showFamilyTree();
                    break;
                case 'whatsapp':
                    showWhatsApp();
                    break;
                default:
                    contentArea.innerHTML = '<div class="loading">Welcome to Nam Kovil Community Portal</div>';
            }
        }
        
        function showMembers() {
            const contentArea = document.getElementById('contentArea');
            if (membersData.length === 0) {
                contentArea.innerHTML = '<div class="content-header"><h2>Members</h2></div><div class="content-body"><div class="error">No members found</div></div>';
                return;
            }
            
            let html = '<div class="content-header"><h2>Members (' + membersData.length + ')</h2></div><div class="content-body"><div class="member-grid">';
            
            membersData.forEach(member => {
                html += '<div class="member-card">';
                html += '<div class="member-name">' + (member.fullName || member.full_name || 'Unknown') + '</div>';
                html += '<div class="member-info">üìß ' + (member.email || 'No email') + '</div>';
                html += '<div class="member-info">üì± ' + (member.phone || 'No phone') + '</div>';
                html += '<div class="member-info">üè† ' + (member.currentCity || member.current_city || 'No city') + '</div>';
                html += '</div>';
            });
            
            html += '</div></div>';
            contentArea.innerHTML = html;
        }
        
        function showTemples() {
            const contentArea = document.getElementById('contentArea');
            if (templesData.length === 0) {
                contentArea.innerHTML = '<div class="content-header"><h2>Temples</h2></div><div class="content-body"><div class="error">No temples found</div></div>';
                return;
            }
            
            let html = '<div class="content-header"><h2>Temples (' + templesData.length + ')</h2></div><div class="content-body"><div class="member-grid">';
            
            templesData.forEach(temple => {
                html += '<div class="member-card">';
                html += '<div class="member-name">' + (temple.templeName || temple.temple_name || 'Unknown Temple') + '</div>';
                html += '<div class="member-info">üïâÔ∏è ' + (temple.deity || 'No deity') + '</div>';
                html += '<div class="member-info">üìç ' + (temple.village || 'No village') + ', ' + (temple.state || 'No state') + '</div>';
                html += '</div>';
            });
            
            html += '</div></div>';
            contentArea.innerHTML = html;
        }
        
        function showRegistry() {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = '<div class="content-header"><h2>Member Registry</h2></div><div class="content-body"><div class="loading">Member registration functionality</div></div>';
        }
        
        function showFamilyTree() {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = '<div class="content-header"><h2>Family Tree</h2></div><div class="content-body"><div class="loading">Family tree visualization</div></div>';
        }
        
        function showWhatsApp() {
            const contentArea = document.getElementById('contentArea');
            contentArea.innerHTML = '<div class="content-header"><h2>WhatsApp Integration</h2></div><div class="content-body"><div class="loading">WhatsApp messaging functionality</div></div>';
        }
        
        document.addEventListener('DOMContentLoaded', loadData);
        setInterval(loadData, 30000); // Refresh every 30 seconds
    </script>
</body>
</html>